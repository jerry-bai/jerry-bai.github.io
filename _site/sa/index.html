<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Sentiment Analysis on Big Issues – Jerry Bai</title> <meta name="description" content="Jerry is currently the full-time principal engineer of Panasonic Avionics Corporation."> <meta name="keywords" content="sentiment analysis, python, natural language processing"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://jerry-bai.github.io/assets/img/logo.png"> <meta name="twitter:title" content="Sentiment Analysis on Big Issues"> <meta name="twitter:description" content="Research Assistant"> <meta name="twitter:site" content="@jerrybai123"> <meta name="twitter:creator" content="@jerrybai123"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Sentiment Analysis on Big Issues"> <meta property="og:description" content="Research Assistant"> <meta property="og:url" content="https://jerry-bai.github.io/sa/"> <meta property="og:site_name" content="Jerry Bai"> <meta property="og:image" content="https://jerry-bai.github.io/assets/img/logo.png"> <link rel="canonical" href="https://jerry-bai.github.io/sa/"> <link href="https://jerry-bai.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Jerry Bai Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://jerry-bai.github.io/assets/css/main.css"> <!-- JS --> <script src="https://jerry-bai.github.io/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <!--<link rel="apple-touch-icon" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-144x144.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://jerry-bai.github.io/favicon.png" /> <link rel="shortcut icon" href="https://jerry-bai.github.io/favicon.ico" />--> <link rel="apple-touch-icon" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="57x57" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-57x57.png"> <link rel="apple-touch-icon" sizes="60x60" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-60x60.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="76x76" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-76x76.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="120x120" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-120x120.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-144x144.png"> <link rel="apple-touch-icon" sizes="152x152" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-152x152.png"> <link rel="apple-touch-icon" sizes="180x180" href="https://jerry-bai.github.io/assets/img/favicons/apple-icon-180x180.png"> <link rel="shortcut icon" type="image/png" href="https://jerry-bai.github.io/favicon.png"> <link rel="shortcut icon" href="https://jerry-bai.github.io/favicon.ico"> <link rel="icon" type="image/png" sizes="192x192" href="https://jerry-bai.github.io/assets/img/favicons/android-icon-192x192.png"> <link rel="icon" type="image/png" sizes="32x32" href="https://jerry-bai.github.io/assets/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="96x96" href="https://jerry-bai.github.io/assets/img/favicons/favicon-96x96.png"> <link rel="icon" type="image/png" sizes="16x16" href="https://jerry-bai.github.io/assets/img/favicons/favicon-16x16.png"> <link rel="manifest" href="https://jerry-bai.github.io/assets/img/favicons/manifest.json"> <meta name="msapplication-TileColor" content="#ffffff"> <meta name="msapplication-TileImage" content="https://jerry-bai.github.io/assets/img/favicons/ms-icon-144x144.png"> <meta name="theme-color" content="#ffffff"> <!-- Background Image --> <style type="text/css">body {background-image:url(https://jerry-bai.github.io/assets/img/placeholder-big.jpg); }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://jerry-bai.github.io/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="https://jerry-bai.github.io/favicon.png" alt="Jerry Bai photo" class="author-photo"> <h4>Jerry Bai</h4> <p>Jerry is currently the full-time principal engineer of Panasonic Avionics Corporation.</p> </li> <li><a href="https://jerry-bai.github.io/academia/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:jerrybai@tutanota.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://twitter.com/jerrybai123" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://linkedin.com/in/jerry-bai-a53a1360" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Academia</a> <ul class="dl-submenu"> <li><a href="https://jerry-bai.github.io/academia/">All Academia Experiences</a></li> <li><a href="https://jerry-bai.github.io/tags/">All Tags</a></li> </ul> </li> <li> <a href="#">Industry</a> <ul class="dl-submenu"> <li><a href="https://jerry-bai.github.io/industry/">All Industry Experiences</a></li> <li><a href="https://jerry-bai.github.io/tags/">All Tags</a></li> </ul> </li> <li> <a href="#">Research</a> <ul class="dl-submenu"> <li><a href="https://jerry-bai.github.io/research/">All Research Experiences</a></li> <li><a href="https://jerry-bai.github.io/tags/">All Tags</a></li> </ul> </li> <!-- <li><a href="https://jerry-bai.github.io/research/" >Research</a></li> --> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Sentiment Analysis on Big Issues</h1> <!--<h4>2016-02-25 00:00:00 -0800</h4>--> <!-- <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~3 minutes </p> --> <a class="btn zoombtn" href="https://jerry-bai.github.io/research/"> <i class="fa fa-chevron-left"></i> </a> </div> <h2 id="research-assistant">Research Assistant</h2> <h3 id="topic">Topic</h3> <p>Analyze debates on debate.org in order to make accurate predictions on anyone’s stand in a debate based on their comments and information.</p> <h3 id="process">Process</h3> <ul> <li> <p>There are 24 big issue topics on debate.org and 20 comments on each topic (10 pro and 10 con). This makes for 480 comments total. I used half for training and half for testing.</p> </li> <li> <p>I used a vocabulary of 5000 words to analyze and learn the words in the comments and create a bag of words model.</p> </li> <li> <p>I trained a random forest (100 decision trees) based on the comments and whether it was a pro or con.</p> </li> <li> <p>Compared my predictions to the gold data.</p> </li> </ul> <h3 id="implementation">Implementation</h3> <p>To parse the debate website and data: <code class="highlighter-rouge">getDebateData.py</code>.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">sock</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">"http://www.debate.org/big-issues/"</span><span class="p">)</span>
<span class="n">bigIssuesSrc</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">bigIssuesSrc</span> <span class="o">=</span> <span class="n">bigIssuesSrc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">"BIG"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">"Previous"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#only html for recent big issues</span>
<span class="n">debate_topics</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r'&lt;a class="issue-title" href="(.*)" title='</span><span class="p">,</span> <span class="n">bigIssuesSrc</span><span class="p">)</span>
<span class="n">num_of_topics</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">debate_topics</span><span class="p">)</span>

<span class="c">#get even number of debates</span>
<span class="k">if</span> <span class="n">num_of_topics</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">debate_topics</span> <span class="o">=</span> <span class="n">debate_topics</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_of_topics</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">num_of_topics</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="c">#split topics in half for training and testing</span>
<span class="n">train_topics</span> <span class="o">=</span> <span class="n">debate_topics</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_of_topics</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">test_topics</span> <span class="o">=</span> <span class="n">debate_topics</span><span class="p">[</span><span class="n">num_of_topics</span><span class="o">/</span><span class="mi">2</span><span class="p">:]</span>

<span class="s">'''
Get the train data
'''</span>

<span class="k">print</span> <span class="s">"Getting the training data"</span>

<span class="n">train_urls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">train_topic</span> <span class="ow">in</span> <span class="n">train_topics</span><span class="p">:</span>
    <span class="n">train_urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"http://www.debate.org"</span> <span class="o">+</span> <span class="n">train_topic</span><span class="p">)</span>

<span class="n">train_output_comments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">train_output_sentiments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">train_output_num_comments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">train_url</span> <span class="ow">in</span> <span class="n">train_urls</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"..."</span><span class="p">)</span>
    <span class="n">train_sock</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">train_url</span><span class="p">)</span>
    <span class="n">train_html_src</span> <span class="o">=</span> <span class="n">train_sock</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">train_sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">train_all_comments</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r'Comment:&lt;</span><span class="err">\</span><span class="s">/strong&gt;(.*)'</span><span class="p">,</span> <span class="n">train_html_src</span><span class="p">)</span>
    <span class="n">train_num_comments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_all_comments</span><span class="p">)</span>
    <span class="n">train_output_num_comments</span> <span class="o">+=</span> <span class="n">train_num_comments</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">train_num_comments</span><span class="p">):</span>
        <span class="n">train_output_comments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_all_comments</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">train_num_comments</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">train_output_sentiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">train_output_sentiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c">#remove \r (bugging up our output csv)</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">train_output_comment</span> <span class="ow">in</span> <span class="n">train_output_comments</span><span class="p">:</span>
    <span class="n">train_output_comments</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_output_comment</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">"</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">outdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">outdict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">"comment"</span><span class="p">:</span><span class="n">train_output_comments</span><span class="p">})</span>
<span class="n">outdict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">"sentiment"</span><span class="p">:</span><span class="n">train_output_sentiments</span><span class="p">})</span>

<span class="n">train_output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">outdict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">train_output_num_comments</span><span class="p">))</span>
<span class="n">train_output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"labeledDebateTrainData.csv"</span><span class="p">)</span>

<span class="s">'''
Get the test data
'''</span>

<span class="k">print</span> <span class="s">"Getting the testing data"</span>
<span class="n">test_urls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">test_topic</span> <span class="ow">in</span> <span class="n">test_topics</span><span class="p">:</span>
    <span class="n">test_urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"http://www.debate.org"</span> <span class="o">+</span> <span class="n">test_topic</span><span class="p">)</span>

<span class="n">test_output_comments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="c">#test_output_sentiments = list()</span>
<span class="n">test_output_num_comments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">test_url</span> <span class="ow">in</span> <span class="n">test_urls</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"..."</span><span class="p">)</span>
    <span class="n">test_sock</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
    <span class="n">test_html_src</span> <span class="o">=</span> <span class="n">test_sock</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">test_sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">test_all_comments</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r'Comment:&lt;</span><span class="err">\</span><span class="s">/strong&gt;(.*)'</span><span class="p">,</span> <span class="n">test_html_src</span><span class="p">)</span>
    <span class="n">test_num_comments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_all_comments</span><span class="p">)</span>
    <span class="n">test_output_num_comments</span> <span class="o">+=</span> <span class="n">test_num_comments</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">test_num_comments</span><span class="p">):</span>
        <span class="n">test_output_comments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_all_comments</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="c">#if i &lt;= test_num_comments/2:</span>
        <span class="c">#    test_output_sentiments.append(1)</span>
        <span class="c">#else:</span>
        <span class="c">#    test_output_sentiments.append(0)</span>

<span class="c">#remove \r (bugging up our output csv)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">test_output_comment</span> <span class="ow">in</span> <span class="n">test_output_comments</span><span class="p">:</span>
    <span class="n">test_output_comments</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_output_comment</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">"</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">outdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">outdict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">"comment"</span><span class="p">:</span><span class="n">test_output_comments</span><span class="p">})</span>
<span class="c">#outdict.update({"sentiment":test_output_sentiments})</span>

<span class="n">test_output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">outdict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">test_output_num_comments</span><span class="p">))</span>
<span class="n">test_output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"labeledDebateTestData.csv"</span><span class="p">)</span>

<span class="s">'''
Get gold test data
'''</span>

<span class="k">print</span> <span class="s">"Getting the gold testing data"</span>
<span class="n">test_urls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">test_topic</span> <span class="ow">in</span> <span class="n">test_topics</span><span class="p">:</span>
    <span class="n">test_urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"http://www.debate.org"</span> <span class="o">+</span> <span class="n">test_topic</span><span class="p">)</span>

<span class="n">test_output_comments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">test_output_sentiments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">test_output_num_comments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">test_url</span> <span class="ow">in</span> <span class="n">test_urls</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"..."</span><span class="p">)</span>
    <span class="n">test_sock</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">test_url</span><span class="p">)</span>
    <span class="n">test_html_src</span> <span class="o">=</span> <span class="n">test_sock</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">test_sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">test_all_comments</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r'Comment:&lt;</span><span class="err">\</span><span class="s">/strong&gt;(.*)'</span><span class="p">,</span> <span class="n">test_html_src</span><span class="p">)</span>
    <span class="n">test_num_comments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_all_comments</span><span class="p">)</span>
    <span class="n">test_output_num_comments</span> <span class="o">+=</span> <span class="n">test_num_comments</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">test_num_comments</span><span class="p">):</span>
        <span class="n">test_output_comments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_all_comments</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">test_num_comments</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">test_output_sentiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">test_output_sentiments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c">#remove \r (bugging up our output csv)</span>
<span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">test_output_comment</span> <span class="ow">in</span> <span class="n">test_output_comments</span><span class="p">:</span>
    <span class="n">test_output_comments</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_output_comment</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">"</span><span class="se">\r</span><span class="s">"</span><span class="p">)</span>
    <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">outdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">outdict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">"comment"</span><span class="p">:</span><span class="n">test_output_comments</span><span class="p">})</span>
<span class="n">outdict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">"sentiment"</span><span class="p">:</span><span class="n">test_output_sentiments</span><span class="p">})</span>

<span class="n">test_output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">outdict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">test_output_num_comments</span><span class="p">))</span>
<span class="n">test_output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"labeledDebateTestData_Gold.csv"</span><span class="p">)</span></code></pre></figure> <p>To perform sentiment analysis: <code class="highlighter-rouge">debateSA.py</code>.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="c">#--read data--#</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"labeledDebateTrainData.csv"</span><span class="p">)</span>

    <span class="n">num_reviews</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">"comment"</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>

    <span class="k">print</span><span class="p">(</span><span class="s">"Creating the bag of words...</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="c">#init bag of words tool, analyze words, max vocabulary of 5000 words</span>
    <span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s">"word"</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">preprocessor</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

    <span class="c">#fit_transform, input is a list of str</span>
    <span class="c"># 1. fit model (learn vocab)</span>
    <span class="c"># 2. transform train data into feature vector</span>
    <span class="n">train_data_features</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">"comment"</span><span class="p">])</span>

    <span class="c">#arrs are easy to work with</span>
    <span class="n">train_data_features</span> <span class="o">=</span> <span class="n">train_data_features</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

    <span class="c">#vocab = vectorizer.get_feature_names()</span>

    <span class="k">print</span> <span class="s">"Training the random forest..."</span>

    <span class="c">#init w/ 100 trees</span>
    <span class="n">forest</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">forest</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_features</span><span class="p">,</span> <span class="n">train</span><span class="p">[</span><span class="s">"sentiment"</span><span class="p">])</span>

    <span class="c">#--DONE TRAINING--#</span>
    <span class="c">#--     ...     --#</span>
    <span class="c">#--Begin testing--#</span>

    <span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"labeledDebateTestData.csv"</span><span class="p">)</span>
    <span class="c">#print test.shape</span>

    <span class="c">#get bag of words for test set, convert to numpy arr</span>
    <span class="n">test_data_features</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">"comment"</span><span class="p">])</span>
    <span class="n">test_data_features</span> <span class="o">=</span> <span class="n">test_data_features</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_features</span><span class="p">)</span>

    <span class="c">#cp results into dataframe</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"comment"</span><span class="p">:</span><span class="n">test</span><span class="p">[</span><span class="s">"comment"</span><span class="p">],</span> <span class="s">"sentiment"</span><span class="p">:</span><span class="n">result</span><span class="p">})</span>
    <span class="n">output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span> <span class="s">"Bag_of_Words_model_debateorg.csv"</span><span class="p">)</span></code></pre></figure> <h3 id="results">Results</h3> <ul> <li>Achieve ~70% accuracy on predicting a user’s take on an issue.</li> </ul> <p><a href="/assets/img/research/files.zip" class="btn">Download Files</a></p> <!----- layout: post title: "A Post with a Video" date: 2016-03-15 excerpt: "Custom written post descriptions are the way to go... if you're not lazy." project: true tag: - sample - post - video comments: true -----> <!--<iframe width="560" height="315" src="//www.youtube.com/embed/SU3kYxJmWuQ" frameborder="0"> </iframe> Video embeds are responsive and scale with the width of the main content block with the help of [FitVids](http://fitvidsjs.com/). Not sure if this only effects Kramdown or if it's an issue with Markdown in general. But adding YouTube video embeds causes errors when building your Jekyll site. To fix add a space between the `<iframe>` tags and remove `allowfullscreen`. Example below: <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;iframe</span> <span class="na">width=</span><span class="s">"560"</span> <span class="na">height=</span><span class="s">"315"</span> <span class="na">src=</span><span class="s">"//www.youtube.com/embed/SU3kYxJmWuQ"</span> <span class="na">frameborder=</span><span class="s">"0"</span><span class="nt">&gt;</span> <span class="nt">&lt;/iframe&gt;</span></code></pre></figure> --> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="https://jerry-bai.github.io/tags/#sentiment%20analysis" title="Pages tagged sentiment analysis" class="tag"><span class="term">sentiment analysis</span></a><a href="https://jerry-bai.github.io/tags/#python" title="Pages tagged python" class="tag"><span class="term">python</span></a><a href="https://jerry-bai.github.io/tags/#natural%20language%20processing" title="Pages tagged natural language processing" class="tag"><span class="term">natural language processing</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://jerry-bai.github.io/sa/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=https://jerry-bai.github.io/sa/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://jerry-bai.github.io/sa/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="https://jerry-bai.github.io/assets/js/jquery-1.12.0.min.js"></script> <script src="https://jerry-bai.github.io/assets/js/jquery.dlmenu.min.js"></script> <script src="https://jerry-bai.github.io/assets/js/jquery.goup.min.js"></script> <script src="https://jerry-bai.github.io/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://jerry-bai.github.io/assets/js/jquery.fitvid.min.js"></script> <script src="https://jerry-bai.github.io/assets/js/scripts.js"></script> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
